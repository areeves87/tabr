<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example: multiple voices • tabr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google analytics --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46129458-3', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">tabr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-info-circle"></span>
     
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tabr-basics.html">Basic example</a>
    </li>
    <li>
      <a href="../articles/tabr-phrases.html">Musical phrases</a>
    </li>
    <li>
      <a href="../articles/tabr-helpers.html">Phrase helpers</a>
    </li>
    <li>
      <a href="../articles/tabr-chords.html">Chords</a>
    </li>
    <li>
      <a href="../articles/tabr-repeats.html">Repeats</a>
    </li>
    <li>
      <a href="../articles/tabr-tracks-scores.html">Tracks and scores</a>
    </li>
    <li>
      <a href="../articles/tabr-engraving.html">Engraving</a>
    </li>
    <li>
      <a href="../articles/tabr-tunings.html">Non-standard tuning</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Examples</li>
    <li>
      <a href="../articles/tabr-ex1.html">Tuning and capo</a>
    </li>
    <li>
      <a href="../articles/tabr-ex2.html">Multiple voices</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-book"></span>
     
    Reference
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/leonawicz/tabr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Example: multiple voices</h1>
            
          </div>

    
    
<div class="contents">
<p>The previous example used a fingerstyle arrangement based on guitar patterns in <em>Devil’s got you beat</em>. This example picks up from there, regenerating the exact same guitar tab, but this time properly acknowledging the two guitar voices: the part played by with the thumb and the part played with the other fingers. The setup is the same as before.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tabr)
header &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">title =</span> <span class="st">"Devil's got you beat"</span>, <span class="dt">composer =</span> <span class="st">"Words and music Blues Saraceno"</span>, 
    <span class="dt">performer =</span> <span class="st">"Blues Saraceno"</span>, <span class="dt">album =</span> <span class="st">"Dark Country 4"</span>, <span class="dt">subtitle =</span> <span class="st">"From the album Dark Country 4 by Blues Saraceno"</span>, 
    <span class="dt">arranger =</span> <span class="st">"Two picking patterns over Eb arranged by Matthew Leonawicz"</span>, 
    <span class="dt">copyright =</span> <span class="st">"2016 Extreme Music"</span>)

txt &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"DADGAD tuning with capo on 1st fret (Eb). Fingerpicking. Let ring."</span>)
tuning &lt;-<span class="st"> "d2 a2 d3 g3 a3 d4"</span></code></pre></div>
<div id="multiple-voices" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-voices" class="anchor"></a>Multiple voices</h2>
<p>In this fingerstyle guitar tab it is appropriate to use two voices for the guitar part. Even though it is one guitar playing, the thumb playing on the low three strings and the fingers playing the higher strings should be shown as two distinct voices. Multiple voices like this go on the same staff; they do not need a separate staff. The voice played with the thumb shows notes with their stems pointing down and the higher voice has stems pointing up.</p>
<p>This changes the phrases seen earlier as they must be split into two complementary phrases. Voice ID is indicated in <code>track</code>. There are now two tracks, but they are represented by different voices, not by different music staves. Therefore, the two tracks will use <code>voice = 1</code> and <code>voice = 2</code>, respectively, but they will not have different <code>tabstaff</code> IDs.</p>
<p>Below, <code>s</code> is used instead of <code>r</code> for silent rests, but this is not required. This suppresses the rest notation of the resting voice while the other voice is active. This works well for this melody since the two voices are never both at rest. Notice how the additional rests fill in the gaps where each voice is now effectively inactive while the other is played. In more complex fingerstyle arrangements they will of course overlap.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># melody 1: voice 1</span>
notes1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/append_phrases.html">glue</a></span>(<span class="kw"><a href="../reference/append_phrases.html">dup</a></span>(<span class="st">"s a3 d4"</span>, <span class="dv">2</span>), <span class="st">"s a3 d4 s"</span>)
info1 &lt;-<span class="st"> "4. 16 16 4. 16 16 8 16 16 4"</span>
strings1 &lt;-<span class="st"> "x 2 1 x 2 1 x 2 1 x"</span>
p1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/phrase.html">p</a></span>(notes1, info1, strings1)

p1e1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/phrase.html">p</a></span>(<span class="st">"s a3 d4 s"</span>, <span class="st">"8 16 16 4"</span>, <span class="st">"x 2 1 x"</span>)
p1e2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/phrase.html">p</a></span>(<span class="st">"s a3 d4 s s"</span>, <span class="st">"8 16 16 4 1"</span>, <span class="st">"x 2 1 x x"</span>)

<span class="co"># melody 1: voice 2</span>
notes2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/append_phrases.html">glue</a></span>(<span class="kw"><a href="../reference/append_phrases.html">dup</a></span>(<span class="st">"f3 d3 c3 d3 s"</span>, <span class="dv">2</span>), <span class="st">"f3 g3 s f3 d3 c3 a2"</span>)
info2 &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/purrr/topics/map">map_chr</a></span>(<span class="kw">c</span>(<span class="st">"16("</span>, <span class="kw"><a href="../reference/notate.html">notate</a></span>(<span class="st">"16("</span>, txt)), <span class="op">~</span><span class="kw"><a href="../reference/append_phrases.html">glue</a></span>(.x, <span class="st">"16) 8 8 8 16( 16) 8 8 8 16- 16 8 16*4"</span>))
strings2 &lt;-<span class="st"> "4 4 5 4 s 4 4 5 4 s 4 4 s 4 4 5 5"</span>
p2 &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/purrr/topics/map">map</a></span>(info2, <span class="op">~</span><span class="kw"><a href="../reference/phrase.html">p</a></span>(notes2, .x, strings2))

p2e1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/phrase.html">p</a></span>(<span class="st">"d3 s c3 a2 f2 d2"</span>, <span class="st">"8 8 16( 16) 16( 16)"</span>, <span class="st">"4 x 5 5 6 6"</span>)
p2e2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/phrase.html">p</a></span>(<span class="st">"d3 s c3 a2 f2 e2 d2"</span>, <span class="st">"8 8 16( 16) 16- 16( 1)"</span>, <span class="st">"4 x 5 5 6 6 6"</span>)

<span class="co"># melody 2: voices 1 and 2</span>
p3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/phrase.html">p</a></span>(<span class="st">"s a3 d4 s"</span>, <span class="st">"8 16 16 4"</span>, <span class="st">"x 2 1 x"</span>)
p4 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/phrase.html">p</a></span>(<span class="st">"d3 s f3 d3 c3"</span>, <span class="st">"8 8 16 16 8"</span>, <span class="st">"4 x 4 4 5"</span>)

t1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/append_phrases.html">glue</a></span>(<span class="kw"><a href="../reference/volta.html">pct</a></span>(<span class="kw"><a href="../reference/append_phrases.html">glue</a></span>(p1, p1e1), <span class="dv">3</span>), <span class="kw"><a href="../reference/volta.html">volta</a></span>(<span class="kw"><a href="../reference/volta.html">pct</a></span>(p3, <span class="dv">3</span>), <span class="dv">1</span>), p1, p1e1, p1, p1e2) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/track.html">track</a></span>(tuning, <span class="dv">1</span>)
t2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/append_phrases.html">glue</a></span>(<span class="kw"><a href="../reference/volta.html">pct</a></span>(<span class="kw"><a href="../reference/append_phrases.html">glue</a></span>(p2[[<span class="dv">2</span>]], p2e1), <span class="dv">3</span>), <span class="kw"><a href="../reference/volta.html">volta</a></span>(<span class="kw"><a href="../reference/volta.html">pct</a></span>(p4, <span class="dv">3</span>), <span class="dv">1</span>), p2[[<span class="dv">1</span>]], p2e1, 
    p2[[<span class="dv">1</span>]], p2e2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/track.html">track</a></span>(tuning, <span class="dv">2</span>)
<span class="kw"><a href="../reference/trackbind.html">trackbind</a></span>(t1, t2, <span class="dt">tabstaff =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/score.html">score</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/tab.html">tab</a></span>(<span class="st">"out.pdf"</span>, <span class="st">"dm"</span>, <span class="st">"4/4"</span>, 
    <span class="st">"4 = 115"</span>, header)</code></pre></div>
<p>Notice the 1 and 2 passed to the respective calls to <code>track</code> for the voice ID. Subsequently, in the call to <code>trackbind</code> the two tracks are assigned the same staff ID, <code>tabstaff = c(1, 1)</code>. By default, not providing <code>tabstaff</code> leads to a unique staff per track. This is the more common usage. Providing non-unique staff IDs will throw an error if the voice IDs for a single staff ID are also not unique. Every track must be directed into a unique voice or staff.</p>
</div>
<div id="result" class="section level2">
<h2 class="hasAnchor">
<a href="#result" class="anchor"></a>Result</h2>
<p>This is a somewhat frustrating refactor for such a small change in result, but keep in mind it is just a comparative example for illustration. Normally, it would only have been coded this second way to begin with. The new output is shown below. It is almost identical, as it should be, with the single exception of a change in stem direction representing the two voices.</p>
<p>Note that the order of voice 1 and 2 <em>assignment</em> determines which one is stem up and which is stem down. <code>voice = 1</code> points up, <code>voice = 2</code> points down, and they should be assigned properly to avoid obtaining the backwards result. Since together these tracks share one staff, the order in which they are passed to <code>trackbind</code> actually does not matter here. <code>trackbind</code> order matters only for staff order, not voice order within a staff. For both voices and staves, first to last is mapped top to bottom in the output.</p>
<p align="center">
<img src="https://github.com/leonawicz/tabr/blob/master/data-raw/vignette-pngs/complete01b.png?raw=true" width="100%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#multiple-voices">Multiple voices</a></li>
      <li><a href="#result">Result</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://leonawicz.github.io/">Matthew Leonawicz</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
